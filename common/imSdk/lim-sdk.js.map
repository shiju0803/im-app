{"version":3,"sources":["webpack://imsdk/webpack/universalModuleDefinition","webpack://imsdk/webpack/bootstrap","webpack://imsdk/./src/lim/log/Logger.ts","webpack://imsdk/./src/lim/common/utils.ts","webpack://imsdk/(webpack)/buildin/global.js","webpack://imsdk/./src/lim/core/ImClient.ts","webpack://imsdk/./src/lim/common/Fetch.ts","webpack://imsdk/./src/lim.ts","webpack://imsdk/./src/lim/codec/ByteBuffer.ts","webpack://imsdk/./src/lim/pack/LoginPack.ts","webpack://imsdk/./src/lim/common/WebToolkit.ts","webpack://imsdk/./src/lim/uniapp/http/uni-fetch.js","webpack://imsdk/./node_modules/websocket/lib/browser.js","webpack://imsdk/./node_modules/es5-ext/global.js","webpack://imsdk/./node_modules/websocket/lib/version.js","webpack://imsdk/./src/lim/model/RequestBase.ts","webpack://imsdk/./src/lim/model/RequestParams.ts","webpack://imsdk/./src/lim/core/HttpApi.ts","webpack://imsdk/./src/lim/model/ApiResponse.ts","webpack://imsdk/./src/lim/common/Command.ts","webpack://imsdk/./src/lim/pack/MessagePack.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__spreadArrays","this","il","arguments","length","Array","k","a","j","jl","Logger","info","message","optionalParams","_i","debug","console","apply","Date","toISOString","infoTag","tag","error","errorTag","trace","e","Error","undefined","stack","Beans","to","target","JSON","parse","stringify","bean","json","copy","replace","replaceJSON","v","toMapByKey","arrs","result","forEach","strEmpty","strNotEmpty","isEmpty","str","uuid","Math","random","toString","slice","getTime","g","Function","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","rejected","done","then","__generator","body","f","y","_","label","sent","trys","ops","verb","iterator","op","TypeError","pop","push","imClient","getLen","limLogin","ImClient","sleep","State","TimeUnit","Logger_1","ByteBuffer_1","LoginPack_1","WebToolkit_1","websocket_1","RequestBase_1","RequestParams_1","HttpApi_1","utils_1","Command_1","MessagePack_1","firstMonitorSocket","second","Unit","Second","_a","setTimeout","url","version","clientType","listeners","state","INIT","lastOfflineMessageSequence","offlineMessageList","httpUrl","getRequestBase","RequestBase","appId","imei","isInit","CONNECTED","getRequestParams","RequestParams","userId","userSign","init","callback","self","resp","ip","port","req","success","err","conn","_this","_b","getDeviceInfo","system","imeiLength","log","isFailed","data","LoginPack","onerror","onSocketErrorEvent","errorHandler","onclose","CLOSEING","onSocketCloseEvent","reason","onmessage","evt","bytebuf","byteBuffer","int32","unpack","command","bodyLen","msgBody","vstring","MessageCommand","MSG_P2P","onP2PMessage","onTestMessage","heartbeatLoop","onLogin","buildMessagePack","messagePack","jsonData","pack","index","error_1","CLOSED","RECONNECTING","onSocketReConnectEvent","onSocketReConnectSuccessEvent","getSingleUserInfo","uid","syncGetUserInfo","api","userIds","getUserInfo","getAllFriend","fromId","start","now","loop","pingPack","SystemCommand","PING","send","createP2PTextMessage","text","MessagePack","buildTxtMessagePack","sendP2PMessage","p2pPack","getUserId","w3cwebsocket","binaryType","tr","clearTimeout","onopen","readyState","OPEN","onSocketConnectEvent","loginPack","len","charCodeAt","Fetch","getFetchToolkit","httpFetch","global","fetch","im","ImClient_1","uni","ByteBuffer","arrayBuf","offset","Type_Byte","Type_Short","Type_UShort","Type_Int32","Type_UInt32","Type_String","Type_VString","Type_Int64","Type_Float","Type_Double","Type_ByteArray","_offset","_list","_littleEndian","_org_buf","constructor","DataView","Uint8Array","buffer","bigEndian","littleEndianfunction","utf8Write","view","setUint8","val","getInt32","splice","uint32","getUint32","blength","string","utf8Read","utf8Length","chr","end","byte","getUint8","String","fromCharCode","vlen","int64","getFloat64","float","getFloat32","double","byteArray","arr","packWithHead","ifHead","ArrayBuffer","setUint32","setInt8","setInt16","setUint16","setInt32","setFloat64","setFloat32","indx","getAvailable","byteLength","Fetch_1","Base64","_keyStr","encode","u","_utf8_encode","isNaN","charAt","decode","indexOf","_utf8_decode","c2","c3","WebToolkit","getBrowserInfo","agent","navigator","userAgent","toLowerCase","REGSTR_EDGE","REGSTR_IE","OLD_IE","REGSTR_FF","REGSTR_CHROME","REGSTR_SAF","REGSTR_OPERA","code","split","browser","browserVersion","match","getWxappInfo","getReactNativeInfo","getUniAppInfo","loadJS","script","document","createElement","fn","type","exist","getElementsByTagName","children","dom","outerHTML","onreadystatechange","onload","src","appendChild","getIpInfoByFetch","request","method","headers","response","res","currentCity","eval","getIpInfoByInsertScript","getIpInfo","base64Encode","base64Decode","globalThis","support","Blob","viewClasses","isArrayBufferView","isView","obj","normalizeName","test","normalizeValue","iteratorFor","items","shift","Headers","map","append","isArray","header","getOwnPropertyNames","consumed","bodyUsed","fileReaderReady","reader","readBlobAsArrayBuffer","blob","FileReader","promise","readAsArrayBuffer","bufferClone","buf","set","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","URLSearchParams","_bodyArrayBuffer","arrayBuffer","isConsumed","byteOffset","readAsText","chars","join","readArrayBufferAsText","formData","oldValue","has","keys","values","entries","methods","Request","input","options","upcased","credentials","signal","toUpperCase","referrer","cache","reParamSearch","form","trim","bytes","decodeURIComponent","parseUniappHeaders","rawHeaders","Response","bodyInit","status","ok","statusText","clone","redirectStatuses","redirect","RangeError","location","DOMException","aborted","toStr","rawBody","requestTask","href","fixUrl","complete","removeEventListener","abortXhr","errMsg","statusCode","abort","addEventListener","polyfill","_globalThis","NativeWebSocket","WebSocket","MozWebSocket","websocket_version","W3CWebSocket","uri","protocols","prop","naiveFallback","configurable","__global__","identifier","ApiResponse_1","HttpApi","params","reqUrl","paramStr","setQueryConfig","_str","substring","rnfetch1","response2ApiResponse","apiResponse","msg","ApiResponse","succeed","isSucceed","FriendShipCommand","GroupCommand","UserEventCommand","ConversationEventCommand","messageId","messageRandom","RangeInteger","messageTime","min","max","range","floor","toId","content","messageBody"],"mappings":"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","file":"lim-sdk.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"imsdk\"] = factory();\n\telse\n\t\troot[\"imsdk\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","\"use strict\";\r\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\nexports.__esModule = true;\r\nvar Logger = /** @class */ (function () {\r\n    function Logger() {\r\n    }\r\n    Logger.info = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.info.apply(console, __spreadArrays([new Date().toISOString() + \" : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.infoTag = function (tag, message) {\r\n        var optionalParams = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 2] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.info.apply(console, __spreadArrays([new Date().toISOString() + \" \" + tag + \" : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.error = function (message) {\r\n        var optionalParams = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 1] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.error.apply(console, __spreadArrays([new Date().toISOString() + \" : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.errorTag = function (tag, message) {\r\n        var optionalParams = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            optionalParams[_i - 2] = arguments[_i];\r\n        }\r\n        if (Logger.debug) {\r\n            console.error.apply(console, __spreadArrays([new Date().toISOString() + \" \" + tag + \"  : \" + message], optionalParams));\r\n        }\r\n    };\r\n    Logger.trace = function (e) {\r\n        if (Logger.debug) {\r\n            if (e instanceof Error) {\r\n                console.error(e.message + \" \\n \" + (e.stack !== undefined ? e.stack : ''));\r\n            }\r\n            else {\r\n                console.error(e);\r\n            }\r\n        }\r\n    };\r\n    Logger.debug = true;\r\n    return Logger;\r\n}());\r\nexports[\"default\"] = Logger;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar Beans = /** @class */ (function () {\r\n    function Beans() {\r\n    }\r\n    Beans.to = function (target) {\r\n        return JSON.parse(JSON.stringify(target));\r\n    };\r\n    Beans.bean = function (json) {\r\n        return JSON.parse(json);\r\n    };\r\n    Beans.copy = function (target) {\r\n        return Beans.to(target);\r\n    };\r\n    Beans.replace = function (target, replaceJSON) {\r\n        var r = Beans.to(target);\r\n        for (var v in replaceJSON) {\r\n            r[v] = replaceJSON[v];\r\n        }\r\n        return r;\r\n    };\r\n    Beans.toMapByKey = function (arrs, key) {\r\n        var result = {};\r\n        arrs.forEach(function (v) {\r\n            if (v.hasOwnProperty(key)) {\r\n                result[key] = v;\r\n            }\r\n        });\r\n        return result;\r\n    };\r\n    Beans.json = function (target) {\r\n        return JSON.stringify(target);\r\n    };\r\n    Beans.strEmpty = function (s) {\r\n        return !!s;\r\n    };\r\n    Beans.strNotEmpty = function (s) {\r\n        return !s;\r\n    };\r\n    Beans.isEmpty = function (str) {\r\n        if (str === null ||\r\n            str === '' ||\r\n            str === undefined ||\r\n            str.length === 0) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    };\r\n    Beans.uuid = function () {\r\n        return (Math.random() * 36).toString(36).slice(2) + new Date().getTime().toString();\r\n    };\r\n    return Beans;\r\n}());\r\nexports[\"default\"] = Beans;\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","\"use strict\";\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nexports.__esModule = true;\r\nexports.imClient = exports.getLen = exports.limLogin = exports.ImClient = exports.sleep = exports.State = void 0;\r\nvar Logger_1 = require(\"../log/Logger\");\r\nvar ByteBuffer_1 = require(\"../codec/ByteBuffer\");\r\nvar LoginPack_1 = require(\"../pack/LoginPack\");\r\nvar WebToolkit_1 = require(\"../common/WebToolkit\");\r\nvar websocket_1 = require(\"websocket\");\r\nvar RequestBase_1 = require(\"../model/RequestBase\");\r\nvar RequestParams_1 = require(\"../model/RequestParams\");\r\nvar HttpApi_1 = require(\"./HttpApi\");\r\nvar utils_1 = require(\"../common/utils\");\r\nvar Command_1 = require(\"../common/Command\");\r\nvar MessagePack_1 = require(\"../pack/MessagePack\");\r\nvar loginTimeout = 10 * 1000; // 10 seconds\r\nvar heartbeatInterval = 10 * 1000; // seconds\r\nvar firstMonitorSocket = false; // 第一次监听socket\r\nvar State;\r\n(function (State) {\r\n    State[State[\"INIT\"] = 0] = \"INIT\";\r\n    State[State[\"CONNECTING\"] = 1] = \"CONNECTING\";\r\n    State[State[\"CONNECTED\"] = 2] = \"CONNECTED\";\r\n    State[State[\"RECONNECTING\"] = 3] = \"RECONNECTING\";\r\n    State[State[\"CLOSEING\"] = 4] = \"CLOSEING\";\r\n    State[State[\"CLOSED\"] = 5] = \"CLOSED\";\r\n})(State = exports.State || (exports.State = {}));\r\nvar TimeUnit;\r\n(function (TimeUnit) {\r\n    TimeUnit[TimeUnit[\"Second\"] = 1000] = \"Second\";\r\n    TimeUnit[TimeUnit[\"Millisecond\"] = 1] = \"Millisecond\";\r\n})(TimeUnit || (TimeUnit = {}));\r\nexports.sleep = function (second, Unit) {\r\n    if (Unit === void 0) { Unit = TimeUnit.Second; }\r\n    return __awaiter(void 0, void 0, void 0, function () {\r\n        return __generator(this, function (_a) {\r\n            return [2 /*return*/, new Promise(function (resolve, _) {\r\n                    setTimeout(function () {\r\n                        resolve();\r\n                    }, second * Unit);\r\n                })];\r\n        });\r\n    });\r\n};\r\nvar ImClient = /** @class */ (function () {\r\n    function ImClient() {\r\n        this.url = \"\";\r\n        this.version = 1;\r\n        this.clientType = 1;\r\n        this.listeners = null;\r\n        this.state = State.INIT;\r\n        this.lastOfflineMessageSequence = 0;\r\n        this.offlineMessageList = new Array();\r\n        this.httpUrl = \"\"; //http://127.0.0.1:8000/v1\r\n    }\r\n    ImClient.prototype.getRequestBase = function () {\r\n        return new RequestBase_1.RequestBase(this.appId, this.clientType, this.imei);\r\n    };\r\n    ImClient.prototype.isInit = function () {\r\n        return this.state == State.CONNECTED;\r\n    };\r\n    ImClient.prototype.getRequestParams = function () {\r\n        return new RequestParams_1.RequestParams(this.appId, this.userId, this.userSign);\r\n    };\r\n    ImClient.prototype.init = function (httpUrl, appId, userId, userSign, listeners, callback) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var self, api, resp, ip, port, req, _a, success, err, conn;\r\n            var _this = this;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        self = this;\r\n                        self.httpUrl = httpUrl;\r\n                        self.appId = appId;\r\n                        self.listeners = listeners;\r\n                        self.imei = WebToolkit_1[\"default\"].getDeviceInfo().system;\r\n                        self.imeiLength = exports.getLen(self.imei);\r\n                        self.userId = userId;\r\n                        this.userSign = userSign;\r\n                        this.imeiLength = self.imeiLength;\r\n                        if (!utils_1[\"default\"].isEmpty(this.url)) return [3 /*break*/, 2];\r\n                        Logger_1[\"default\"].info(\"获取im地址\");\r\n                        api = new HttpApi_1[\"default\"](this.httpUrl);\r\n                        return [4 /*yield*/, api.call(\"/user/login\", {}, { clientType: this.clientType, appId: this.appId, userId: this.userId })];\r\n                    case 1:\r\n                        resp = _b.sent();\r\n                        console.log(resp);\r\n                        if (resp.isFailed()) {\r\n                            Logger_1[\"default\"].info(\"登录失败：获取im地址失败\");\r\n                            return [2 /*return*/];\r\n                        }\r\n                        ip = resp.data.ip;\r\n                        port = resp.data.port;\r\n                        this.url = \"ws://\" + ip + \":\" + port + \"/ws\";\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        req = new LoginPack_1.LoginPack(self.appId, self.userId, 1);\r\n                        return [4 /*yield*/, exports.limLogin(self.url, req, self)];\r\n                    case 3:\r\n                        _a = _b.sent(), success = _a.success, err = _a.err, conn = _a.conn;\r\n                        if (success) {\r\n                            if (!firstMonitorSocket) {\r\n                                firstMonitorSocket = true;\r\n                            }\r\n                            //登录成功以后操作\r\n                            conn.onerror = function (error) {\r\n                                Logger_1[\"default\"].info(\"websocket error: \", error);\r\n                                // 加入socket 连接事件\r\n                                if (typeof exports.imClient.listeners.onSocketErrorEvent === 'function') {\r\n                                    exports.imClient.listeners.onSocketErrorEvent(error);\r\n                                }\r\n                                _this.errorHandler(error, req);\r\n                            };\r\n                            conn.onclose = function (e) {\r\n                                Logger_1[\"default\"].info(\"event[onclose] fired\");\r\n                                if (self.state == State.CLOSEING) {\r\n                                    _this.onclose(\"logout\");\r\n                                    return;\r\n                                }\r\n                                // 加入socket 连接事件\r\n                                if (typeof exports.imClient.listeners.onSocketErrorEvent === 'function') {\r\n                                    exports.imClient.listeners.onSocketCloseEvent();\r\n                                }\r\n                                _this.errorHandler(new Error(e.reason), req);\r\n                            };\r\n                            conn.onmessage = function (evt) {\r\n                                var bytebuf = new ByteBuffer_1[\"default\"](evt.data);\r\n                                var byteBuffer = bytebuf.int32().int32().unpack();\r\n                                var command = byteBuffer[0]; //解析command\r\n                                var bodyLen = byteBuffer[1]; //解析bodylen\r\n                                var unpack = bytebuf.vstring(null, bodyLen).unpack(); //解析出字符串\r\n                                var msgBody = unpack[2];\r\n                                console.log(\"sdk收到服务端数据：  \" + msgBody);\r\n                                if (command === Command_1.MessageCommand.MSG_P2P) {\r\n                                    //单聊消息收发\r\n                                    if (typeof exports.imClient.listeners.onP2PMessage === 'function') {\r\n                                        exports.imClient.listeners.onP2PMessage(msgBody);\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    if (typeof exports.imClient.listeners.onTestMessage === 'function') {\r\n                                        exports.imClient.listeners.onTestMessage(msgBody);\r\n                                    }\r\n                                }\r\n                            };\r\n                            this.conn = conn;\r\n                            this.state = State.CONNECTED;\r\n                            //拉取离线消息\r\n                            // this.loadOfflineMessage();\r\n                            //心跳包\r\n                            this.heartbeatLoop(this.conn);\r\n                            if (typeof exports.imClient.listeners.onLogin === 'function') {\r\n                                exports.imClient.listeners.onLogin(this.userId);\r\n                            }\r\n                            callback(self);\r\n                        }\r\n                        else {\r\n                            Logger_1[\"default\"].error(err === null || err === void 0 ? void 0 : err.message);\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    ImClient.prototype.buildMessagePack = function (command, messagePack) {\r\n        var jsonData = JSON.stringify(messagePack);\r\n        var bodyLen = exports.getLen(jsonData);\r\n        var pack = new ByteBuffer_1[\"default\"](null, 0);\r\n        pack.int32(command).int32(this.version).int32(this.clientType)\r\n            .int32(0x0)\r\n            .int32(this.appId)\r\n            .int32(this.imeiLength)\r\n            .int32(bodyLen)\r\n            .vstring(this.imei, this.imeiLength)\r\n            .vstring(jsonData, bodyLen);\r\n        return pack;\r\n    };\r\n    // 4. 自动重连\r\n    ImClient.prototype.errorHandler = function (error, req) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var index, _a, success, err, conn, error_1;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        // 如果是主动断开连接，就没有必要自动重连\r\n                        // 比如收到被踢，或者主动调用logout()方法\r\n                        if (this.state == State.CLOSED || this.state == State.CLOSEING) {\r\n                            return [2 /*return*/];\r\n                        }\r\n                        this.state = State.RECONNECTING;\r\n                        if (typeof exports.imClient.listeners.onSocketReConnectEvent === 'function') {\r\n                            exports.imClient.listeners.onSocketReConnectEvent();\r\n                        }\r\n                        index = 0;\r\n                        _b.label = 1;\r\n                    case 1:\r\n                        if (!(index < 10)) return [3 /*break*/, 7];\r\n                        return [4 /*yield*/, exports.sleep(3)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        _b.trys.push([3, 5, , 6]);\r\n                        Logger_1[\"default\"].info(\"try to relogin\");\r\n                        return [4 /*yield*/, exports.limLogin(this.url, req, this)];\r\n                    case 4:\r\n                        _a = _b.sent(), success = _a.success, err = _a.err, conn = _a.conn;\r\n                        if (success) {\r\n                            if (typeof exports.imClient.listeners.onSocketReConnectSuccessEvent === 'function') {\r\n                                exports.imClient.listeners.onSocketReConnectSuccessEvent();\r\n                            }\r\n                            return [2 /*return*/];\r\n                        }\r\n                        Logger_1[\"default\"].info(err);\r\n                        return [3 /*break*/, 6];\r\n                    case 5:\r\n                        error_1 = _b.sent();\r\n                        Logger_1[\"default\"].info(error_1);\r\n                        return [3 /*break*/, 6];\r\n                    case 6:\r\n                        index++;\r\n                        return [3 /*break*/, 1];\r\n                    case 7:\r\n                        this.onclose(\"reconnect timeout\");\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // 表示连接中止\r\n    ImClient.prototype.onclose = function (reason) {\r\n        if (this.state == State.CLOSED) {\r\n            return;\r\n        }\r\n        this.state = State.CLOSED;\r\n        Logger_1[\"default\"].info(\"connection closed due to \" + reason);\r\n        this.conn = undefined;\r\n        this.userId = \"\";\r\n        // 加入socket 关闭事件\r\n        if (typeof exports.imClient.listeners.onSocketErrorEvent === 'function') {\r\n            exports.imClient.listeners.onSocketCloseEvent();\r\n        }\r\n    };\r\n    ImClient.prototype.getSingleUserInfo = function (uid) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, _) {\r\n            var api = new HttpApi_1[\"default\"](_this.httpUrl);\r\n            var resp = api.call(\"/user/data/getSingleUserInfo\", _this.getRequestParams(), { userId: uid });\r\n            resolve(resp);\r\n        });\r\n    };\r\n    ImClient.prototype.syncGetUserInfo = function (userId) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var api, resp;\r\n            return __generator(this, function (_a) {\r\n                api = new HttpApi_1[\"default\"](this.httpUrl);\r\n                resp = api.call(\"/user/data/getUserInfo\", this.getRequestParams(), { userIds: userId });\r\n                return [2 /*return*/, resp];\r\n            });\r\n        });\r\n    };\r\n    ImClient.prototype.getUserInfo = function (userId) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, _) {\r\n            var api = new HttpApi_1[\"default\"](_this.httpUrl);\r\n            var resp = api.call(\"/user/data/getUserInfo\", _this.getRequestParams(), { userIds: userId });\r\n            resolve(resp);\r\n        });\r\n    };\r\n    ImClient.prototype.getAllFriend = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve, _) {\r\n            var api = new HttpApi_1[\"default\"](_this.httpUrl);\r\n            var resp = api.call(\"/friendship/getAllFriendShip\", _this.getRequestParams(), { fromId: _this.userId });\r\n            resolve(resp);\r\n        });\r\n    };\r\n    // 2、心跳\r\n    ImClient.prototype.heartbeatLoop = function (conn) {\r\n        var _this = this;\r\n        var start = Date.now();\r\n        var loop = function () {\r\n            if (_this.state != State.CONNECTED) {\r\n                Logger_1[\"default\"].error(\"heartbeatLoop exited\");\r\n                return;\r\n            }\r\n            if (Date.now() - start >= heartbeatInterval) {\r\n                Logger_1[\"default\"].info(\">>> send ping ;\");\r\n                start = Date.now();\r\n                var pingPack = exports.imClient.buildMessagePack(Command_1.SystemCommand.PING, {});\r\n                conn.send(pingPack.pack(false));\r\n            }\r\n            setTimeout(loop, 500);\r\n        };\r\n        setTimeout(loop, 500);\r\n    };\r\n    //构建单聊消息对象\r\n    ImClient.prototype.createP2PTextMessage = function (to, text) {\r\n        var messagePack = new MessagePack_1.MessagePack(this.appId);\r\n        messagePack.buildTxtMessagePack(this.userId, to, text);\r\n        return messagePack;\r\n    };\r\n    ImClient.prototype.sendP2PMessage = function (pack) {\r\n        var p2pPack = exports.imClient.buildMessagePack(Command_1.MessageCommand.MSG_P2P, pack);\r\n        if (this.conn) {\r\n            this.conn.send(p2pPack.pack(false));\r\n        }\r\n    };\r\n    ImClient.prototype.getUserId = function () {\r\n        return this.userId;\r\n    };\r\n    return ImClient;\r\n}());\r\nexports.ImClient = ImClient;\r\nexports.limLogin = function (url, req, imClient) { return __awaiter(void 0, void 0, void 0, function () {\r\n    return __generator(this, function (_a) {\r\n        return [2 /*return*/, new Promise(function (resolve, _) {\r\n                var conn = new websocket_1.w3cwebsocket(url);\r\n                conn.binaryType = \"arraybuffer\";\r\n                Logger_1[\"default\"].info(\"limLogin\");\r\n                // 设置一个登陆超时器\r\n                var tr = setTimeout(function () {\r\n                    clearTimeout(tr);\r\n                    resolve({ success: false, err: new Error(\"timeout\"), conn: conn });\r\n                }, loginTimeout);\r\n                conn.onopen = function () {\r\n                    if (conn.readyState == websocket_1.w3cwebsocket.OPEN) {\r\n                        // 加入socket 连接事件\r\n                        if (typeof imClient.listeners.onSocketConnectEvent === 'function') {\r\n                            imClient.listeners.onSocketConnectEvent(url, req);\r\n                        }\r\n                        Logger_1[\"default\"].info(\"\\u5F00\\u542F\\u8FDE\\u63A5\");\r\n                        //登录数据包\r\n                        var data = {\r\n                            \"userId\": req.userId\r\n                        };\r\n                        var loginPack = imClient.buildMessagePack(0x2328, data);\r\n                        conn.send(loginPack.pack(false));\r\n                    }\r\n                };\r\n                conn.onerror = function (error) {\r\n                    clearTimeout(tr);\r\n                    Logger_1[\"default\"].error(error);\r\n                    resolve({ success: false, err: error, conn: conn });\r\n                };\r\n                conn.onmessage = function (evt) {\r\n                    if (typeof evt.data === 'string') {\r\n                        Logger_1[\"default\"].info(\"Received: '\" + evt.data + \"'\");\r\n                        return;\r\n                    }\r\n                    clearTimeout(tr);\r\n                    var bytebuf = new ByteBuffer_1[\"default\"](evt.data);\r\n                    var byteBuffer = bytebuf.int32().int32().unpack();\r\n                    var command = byteBuffer[0];\r\n                    var bodyLen = byteBuffer[1];\r\n                    if (command == 0x2329) {\r\n                        resolve({ success: true, conn: conn });\r\n                    }\r\n                };\r\n            })];\r\n    });\r\n}); };\r\nexports.getLen = function (str) {\r\n    var len = 0;\r\n    for (var i = 0; i < str.length; i++) {\r\n        var c = str.charCodeAt(i);\r\n        //单字节加1\r\n        if ((c >= 0x0001 && c <= 0x007e) || (0xff60 <= c && c <= 0xff9f)) {\r\n            len++;\r\n        }\r\n        else {\r\n            len += 3;\r\n        }\r\n    }\r\n    return len;\r\n};\r\nexports.imClient = new ImClient();\r\n","\"use strict\";\r\nexports.__esModule = true;\r\n/**\r\n * 返回平台所用的 fetch 工具\r\n * */\r\nvar Fetch = /** @class */ (function () {\r\n    function Fetch() {\r\n    }\r\n    Fetch.getFetchToolkit = function () {\r\n        var httpFetch;\r\n        // @ts-ignore\r\n        if (typeof global.fetch !== 'undefined' && typeof global.fetch === 'function') {\r\n            // @ts-ignore\r\n            httpFetch = global.fetch;\r\n        }\r\n        else if (typeof fetch === 'function') {\r\n            httpFetch = fetch; // RN FETCH\r\n        }\r\n        else {\r\n            var uniFetch = require(\"../uniapp/http/uni-fetch\");\r\n            httpFetch = uniFetch.fetch;\r\n        }\r\n        return httpFetch;\r\n    };\r\n    return Fetch;\r\n}());\r\nexports[\"default\"] = Fetch;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.im = void 0;\r\nvar ImClient_1 = require(\"./lim/core/ImClient\");\r\nexports.im = ImClient_1.imClient;\r\nif (typeof window !== 'undefined') {\r\n    console.log(\"window\");\r\n}\r\nif (typeof global !== 'undefined') {\r\n    console.log(\"global\");\r\n}\r\n// @ts-ignore\r\nif (typeof uni !== 'undefined') {\r\n    // console.log(\"uni\");\r\n    // @ts-ignore\r\n    uni['im'] = ImClient_1.imClient;\r\n    // @ts-ignore\r\n    // uni['im_webtoolkit'] = WebToolkit;\r\n}\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar ByteBuffer = /** @class */ (function () {\r\n    function ByteBuffer(arrayBuf, offset) {\r\n        this.Type_Byte = 1;\r\n        this.Type_Short = 2;\r\n        this.Type_UShort = 3;\r\n        this.Type_Int32 = 4;\r\n        this.Type_UInt32 = 5;\r\n        this.Type_String = 6; //变长字符串，前两个字节表示长度\r\n        this.Type_VString = 7; //定长字符串\r\n        this.Type_Int64 = 8;\r\n        this.Type_Float = 9;\r\n        this.Type_Double = 10;\r\n        this.Type_ByteArray = 11;\r\n        this._offset = 0;\r\n        this._list = [];\r\n        this._littleEndian = false;\r\n        this._org_buf = arrayBuf ? (arrayBuf.constructor == DataView ? arrayBuf\r\n            : (arrayBuf.constructor == Uint8Array ? new DataView(arrayBuf.buffer, offset) : new DataView(arrayBuf, offset))) : new DataView(new Uint8Array([]).buffer);\r\n        this.arrayBuf = arrayBuf;\r\n        this.offset = offset;\r\n        // if (!ArrayBuffer.prototype.slice) {\r\n        //     ArrayBuffer.prototype.slice = function (start, end) {\r\n        //         var that = new Uint8Array(this);\r\n        //         if (end == undefined) end = that.length;\r\n        //         var result = new ArrayBuffer(end - start);\r\n        //         var resultArray = new Uint8Array(result);\r\n        //         for (var i = 0; i < resultArray.length; i++)\r\n        //             resultArray[i] = that[i + start];\r\n        //         return result;\r\n        //     }\r\n        // }\r\n    }\r\n    //指定字节序 为BigEndian\r\n    ByteBuffer.prototype.bigEndian = function () {\r\n        this._littleEndian = false;\r\n        return this;\r\n    };\r\n    ;\r\n    //指定字节序 为LittleEndian\r\n    ByteBuffer.prototype.littleEndianfunction = function () {\r\n        this._littleEndian = true;\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.utf8Write = function (view, offset, str) {\r\n        var c = 0;\r\n        for (var i = 0, l = str.length; i < l; i++) {\r\n            c = str.charCodeAt(i);\r\n            if (c < 0x80) {\r\n                view.setUint8(offset++, c);\r\n            }\r\n            else if (c < 0x800) {\r\n                view.setUint8(offset++, 0xc0 | (c >> 6));\r\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\r\n            }\r\n            else if (c < 0xd800 || c >= 0xe000) {\r\n                view.setUint8(offset++, 0xe0 | (c >> 12));\r\n                view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\r\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\r\n            }\r\n            else {\r\n                i++;\r\n                c = 0x10000 + (((c & 0x3ff) << 10) | (str.charCodeAt(i) & 0x3ff));\r\n                view.setUint8(offset++, 0xf0 | (c >> 18));\r\n                view.setUint8(offset++, 0x80 | (c >> 12) & 0x3f);\r\n                view.setUint8(offset++, 0x80 | (c >> 6) & 0x3f);\r\n                view.setUint8(offset++, 0x80 | (c & 0x3f));\r\n            }\r\n        }\r\n    };\r\n    // byte (val, index) {\r\n    //     if (arguments.length == 0) {\r\n    //         this._list.push(this._org_buf.getUint8(this._offset, this._littleEndian));\r\n    //         this._offset += 1;\r\n    //     } else {\r\n    //         this._list.splice(index != undefined ? index : this._list.length, 0);\r\n    //         this._offset += 1;\r\n    //     }\r\n    //     return this;\r\n    // };\r\n    // short(val:number, index:number) {\r\n    //     if (arguments.length == 0) {\r\n    //         this._list.push(this._org_buf.getInt16(this._offset, this._littleEndian));\r\n    //         this._offset += 2;\r\n    //     } else {\r\n    //         this._list.splice(index != undefined ? index : this._list.length, 0, this.Type_Short);\r\n    //         this._offset += 2;\r\n    //     }\r\n    //     return this;\r\n    // };\r\n    // ushort(val, index) {\r\n    //     if (arguments.length == 0) {\r\n    //         this._list.push(this._org_buf.getUint16(this._offset, this._littleEndian));\r\n    //         this._offset += 2;\r\n    //     } else {\r\n    //         // , {t: this.Type_UShort, d: val, l: 2}\r\n    //         this._list.splice(index != undefined ? index : this._list.length, 0);\r\n    //         this._offset += 2;\r\n    //     }\r\n    //     return this;\r\n    // };\r\n    ByteBuffer.prototype.int32 = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getInt32(this._offset, this._littleEndian));\r\n            this._offset += 4;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Int32, d: val, l: 4 });\r\n            this._offset += 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.uint32 = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getUint32(this._offset, this._littleEndian));\r\n            this._offset += 4;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_UInt32, d: val, l: 4 });\r\n            this._offset += 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    /**\r\n     * 新加的方法，获取bytebuffer的长度\r\n     */\r\n    ByteBuffer.prototype.blength = function () {\r\n        return this._offset;\r\n    };\r\n    ;\r\n    /**\r\n         * 变长字符串 前4个字节表示字符串长度\r\n         **/\r\n    ByteBuffer.prototype.string = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            var len = this._org_buf.getInt32(this._offset, this._littleEndian);\r\n            this._offset += 4;\r\n            this._list.push(this.utf8Read(this._org_buf, this._offset, len));\r\n            this._offset += len;\r\n        }\r\n        else {\r\n            var len = 0;\r\n            if (val) {\r\n                len = this.utf8Length(val);\r\n            }\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_String, d: val, l: len });\r\n            this._offset += len + 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.utf8Length = function (str) {\r\n        var c = 0, length = 0;\r\n        for (var i = 0, l = str.length; i < l; i++) {\r\n            c = str.charCodeAt(i);\r\n            if (c < 0x80) {\r\n                length += 1;\r\n            }\r\n            else if (c < 0x800) {\r\n                length += 2;\r\n            }\r\n            else if (c < 0xd800 || c >= 0xe000) {\r\n                length += 3;\r\n            }\r\n            else {\r\n                i++;\r\n                length += 4;\r\n            }\r\n        }\r\n        return length;\r\n    };\r\n    ByteBuffer.prototype.utf8Read = function (view, offset, length) {\r\n        var string = '', chr = 0;\r\n        for (var i = offset, end = offset + length; i < end; i++) {\r\n            var byte = view.getUint8(i);\r\n            if ((byte & 0x80) === 0x00) {\r\n                string += String.fromCharCode(byte);\r\n                continue;\r\n            }\r\n            if ((byte & 0xe0) === 0xc0) {\r\n                string += String.fromCharCode(((byte & 0x0f) << 6) |\r\n                    (view.getUint8(++i) & 0x3f));\r\n                continue;\r\n            }\r\n            if ((byte & 0xf0) === 0xe0) {\r\n                string += String.fromCharCode(((byte & 0x0f) << 12) |\r\n                    ((view.getUint8(++i) & 0x3f) << 6) |\r\n                    ((view.getUint8(++i) & 0x3f) << 0));\r\n                continue;\r\n            }\r\n            if ((byte & 0xf8) === 0xf0) {\r\n                chr = ((byte & 0x07) << 18) |\r\n                    ((view.getUint8(++i) & 0x3f) << 12) |\r\n                    ((view.getUint8(++i) & 0x3f) << 6) |\r\n                    ((view.getUint8(++i) & 0x3f) << 0);\r\n                if (chr >= 0x010000) { // surrogate pair\r\n                    chr -= 0x010000;\r\n                    string += String.fromCharCode((chr >>> 10) + 0xD800, (chr & 0x3FF) + 0xDC00);\r\n                }\r\n                else {\r\n                    string += String.fromCharCode(chr);\r\n                }\r\n                continue;\r\n            }\r\n            throw new Error('Invalid byte ' + byte.toString(16));\r\n        }\r\n        return string;\r\n    };\r\n    /**\r\n     * 定长字符串 val为null时，读取定长字符串（需指定长度len）\r\n     **/\r\n    ByteBuffer.prototype.vstring = function (val, len, index) {\r\n        if (!len) {\r\n            throw new Error('vstring must got len argument');\r\n            return this;\r\n        }\r\n        if (val == undefined || val == null) {\r\n            var vlen = 0; //实际长度\r\n            for (var i = this._offset; i < this._offset + len; i++) {\r\n                if (this._org_buf.getUint8(i) > 0)\r\n                    vlen++;\r\n            }\r\n            this._list.push(this.utf8Read(this._org_buf, this._offset, vlen));\r\n            this._offset += len;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_VString, d: val, l: len });\r\n            this._offset += len;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.int64 = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getFloat64(this._offset, this._littleEndian));\r\n            this._offset += 8;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Int64, d: val, l: 8 });\r\n            this._offset += 8;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.float = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getFloat32(this._offset, this._littleEndian));\r\n            this._offset += 4;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Float, d: val, l: 4 });\r\n            this._offset += 4;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    ByteBuffer.prototype.double = function (val, index) {\r\n        if (arguments.length == 0) {\r\n            this._list.push(this._org_buf.getFloat64(this._offset, this._littleEndian));\r\n            this._offset += 8;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_Double, d: val, l: 8 });\r\n            this._offset += 8;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    /**\r\n     * 写入或读取一段字节数组\r\n     **/\r\n    ByteBuffer.prototype.byteArray = function (val, len, index) {\r\n        if (!len) {\r\n            throw new Error('byteArray must got len argument');\r\n            return this;\r\n        }\r\n        if (val == undefined || val == null) {\r\n            var arr = new Uint8Array(this._org_buf.buffer.slice(this._offset, this._offset + len));\r\n            this._list.push(arr);\r\n            this._offset += len;\r\n        }\r\n        else {\r\n            this._list.splice(index != undefined ? index : this._list.length, 0, { t: this.Type_ByteArray, d: val, l: len });\r\n            this._offset += len;\r\n        }\r\n        return this;\r\n    };\r\n    ;\r\n    /**\r\n     * 解包成数据数组\r\n     **/\r\n    ByteBuffer.prototype.unpack = function () {\r\n        return this._list;\r\n    };\r\n    ;\r\n    /**\r\n     * 打包成二进制,在前面加上4个字节表示包长\r\n     **/\r\n    ByteBuffer.prototype.packWithHead = function () {\r\n        return this.pack(true);\r\n    };\r\n    ;\r\n    /**\r\n         * 打包成二进制\r\n         * @param ifHead 是否在前面加上4个字节表示包长\r\n         **/\r\n    ByteBuffer.prototype.pack = function (ifHead) {\r\n        this._org_buf = new DataView(new ArrayBuffer((ifHead) ? this._offset + 4 : this._offset));\r\n        var offset = 0;\r\n        if (ifHead) {\r\n            this._org_buf.setUint32(offset, this._offset, this._littleEndian);\r\n            offset += 4;\r\n        }\r\n        for (var i = 0; i < this._list.length; i++) {\r\n            switch (this._list[i].t) {\r\n                case this.Type_Byte:\r\n                    this._org_buf.setInt8(offset, this._list[i].d);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Short:\r\n                    this._org_buf.setInt16(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_UShort:\r\n                    this._org_buf.setUint16(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Int32:\r\n                    this._org_buf.setInt32(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_UInt32:\r\n                    this._org_buf.setUint32(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_String:\r\n                    //前4个字节表示字符串长度\r\n                    this._org_buf.setUint32(offset, this._list[i].l, this._littleEndian);\r\n                    offset += 4;\r\n                    this.utf8Write(this._org_buf, offset, this._list[i].d);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_VString:\r\n                    this.utf8Write(this._org_buf, offset, this._list[i].d);\r\n                    var vlen = this.utf8Length(this._list[i].d); //字符串实际长度\r\n                    //补齐\\0\r\n                    for (var j = offset + vlen; j < offset + this._list[i].l; j++) {\r\n                        this._org_buf.setUint8(j, 0);\r\n                    }\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Int64:\r\n                    this._org_buf.setFloat64(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Float:\r\n                    this._org_buf.setFloat32(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_Double:\r\n                    this._org_buf.setFloat64(offset, this._list[i].d, this._littleEndian);\r\n                    offset += this._list[i].l;\r\n                    break;\r\n                case this.Type_ByteArray:\r\n                    var indx = 0;\r\n                    for (var j = offset; j < offset + this._list[i].l; j++) {\r\n                        if (indx < this._list[i].d.length) {\r\n                            this._org_buf.setUint8(j, this._list[i].d[indx]);\r\n                        }\r\n                        else { //不够的话，后面补齐0x00\r\n                            this._org_buf.setUint8(j, 0);\r\n                        }\r\n                        indx++;\r\n                    }\r\n                    offset += this._list[i].l;\r\n                    break;\r\n            }\r\n        }\r\n        return this._org_buf.buffer;\r\n    };\r\n    ;\r\n    /**\r\n     * 未读数据长度\r\n     **/\r\n    ByteBuffer.prototype.getAvailable = function () {\r\n        if (!this._org_buf)\r\n            return this._offset;\r\n        return this._org_buf.buffer.byteLength - this._offset;\r\n    };\r\n    ;\r\n    return ByteBuffer;\r\n}());\r\nexports[\"default\"] = ByteBuffer;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.LoginPack = void 0;\r\nvar LoginPack = /** @class */ (function () {\r\n    function LoginPack(appId, userId, clientType) {\r\n        this.userId = userId;\r\n        this.clientType = clientType;\r\n        this.appId = appId;\r\n    }\r\n    return LoginPack;\r\n}());\r\nexports.LoginPack = LoginPack;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar Fetch_1 = require(\"../common/Fetch\");\r\nvar Logger_1 = require(\"../log/Logger\");\r\nvar Base64 = {\r\n    _keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\",\r\n    encode: function (e) {\r\n        var t = \"\";\r\n        var n, r, i, s, o, u, a;\r\n        var f = 0;\r\n        e = Base64._utf8_encode(e);\r\n        while (f < e.length) {\r\n            n = e.charCodeAt(f++);\r\n            r = e.charCodeAt(f++);\r\n            i = e.charCodeAt(f++);\r\n            s = n >> 2;\r\n            o = (n & 3) << 4 | r >> 4;\r\n            u = (r & 15) << 2 | i >> 6;\r\n            a = i & 63;\r\n            if (isNaN(r)) {\r\n                u = a = 64;\r\n            }\r\n            else if (isNaN(i)) {\r\n                a = 64;\r\n            }\r\n            t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a);\r\n        }\r\n        return t;\r\n    },\r\n    decode: function (e) {\r\n        var t = \"\";\r\n        var n, r, i;\r\n        var s, o, u, a;\r\n        var f = 0;\r\n        e = e.replace(/[^A-Za-z0-9+/=]/g, \"\");\r\n        while (f < e.length) {\r\n            s = this._keyStr.indexOf(e.charAt(f++));\r\n            o = this._keyStr.indexOf(e.charAt(f++));\r\n            u = this._keyStr.indexOf(e.charAt(f++));\r\n            a = this._keyStr.indexOf(e.charAt(f++));\r\n            n = s << 2 | o >> 4;\r\n            r = (o & 15) << 4 | u >> 2;\r\n            i = (u & 3) << 6 | a;\r\n            t = t + String.fromCharCode(n);\r\n            if (u != 64) {\r\n                t = t + String.fromCharCode(r);\r\n            }\r\n            if (a != 64) {\r\n                t = t + String.fromCharCode(i);\r\n            }\r\n        }\r\n        t = Base64._utf8_decode(t);\r\n        return t;\r\n    },\r\n    _utf8_encode: function (e) {\r\n        e = e.replace(/rn/g, \"n\");\r\n        var t = \"\";\r\n        for (var n = 0; n < e.length; n++) {\r\n            var r = e.charCodeAt(n);\r\n            if (r < 128) {\r\n                t += String.fromCharCode(r);\r\n            }\r\n            else if (r > 127 && r < 2048) {\r\n                t += String.fromCharCode(r >> 6 | 192);\r\n                t += String.fromCharCode(r & 63 | 128);\r\n            }\r\n            else {\r\n                t += String.fromCharCode(r >> 12 | 224);\r\n                t += String.fromCharCode(r >> 6 & 63 | 128);\r\n                t += String.fromCharCode(r & 63 | 128);\r\n            }\r\n        }\r\n        return t;\r\n    },\r\n    _utf8_decode: function (e) {\r\n        var t = \"\";\r\n        var n = 0;\r\n        var r = 0;\r\n        var c1 = 0;\r\n        var c2 = 0;\r\n        while (n < e.length) {\r\n            r = e.charCodeAt(n);\r\n            if (r < 128) {\r\n                t += String.fromCharCode(r);\r\n                n++;\r\n            }\r\n            else if (r > 191 && r < 224) {\r\n                c2 = e.charCodeAt(n + 1);\r\n                t += String.fromCharCode((r & 31) << 6 | c2 & 63);\r\n                n += 2;\r\n            }\r\n            else {\r\n                c2 = e.charCodeAt(n + 1);\r\n                var c3 = e.charCodeAt(n + 2);\r\n                t += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63);\r\n                n += 3;\r\n            }\r\n        }\r\n        return t;\r\n    }\r\n};\r\nvar WebToolkit = /** @class */ (function () {\r\n    function WebToolkit() {\r\n    }\r\n    // 获取浏览器信息\r\n    WebToolkit.getBrowserInfo = function () {\r\n        var agent = navigator.userAgent.toLowerCase();\r\n        var system = agent.split(\" \")[1].split(\" \")[0].split(\"(\")[1];\r\n        var REGSTR_EDGE = /edge\\/[\\d.]+/gi;\r\n        var REGSTR_IE = /trident\\/[\\d.]+/gi;\r\n        var OLD_IE = /msie\\s[\\d.]+/gi;\r\n        var REGSTR_FF = /firefox\\/[\\d.]+/gi;\r\n        var REGSTR_CHROME = /chrome\\/[\\d.]+/gi;\r\n        var REGSTR_SAF = /safari\\/[\\d.]+/gi;\r\n        var REGSTR_OPERA = /opr\\/[\\d.]+/gi;\r\n        var info = {\r\n            code: 0,\r\n            system: system,\r\n            browser: \"\",\r\n            browserVersion: \"\"\r\n        };\r\n        // IE\r\n        if (agent.indexOf(\"trident\") > 0) {\r\n            info.browser = agent.match(REGSTR_IE)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_IE)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // OLD_IE\r\n        if (agent.indexOf(\"msie\") > 0) {\r\n            info.browser = agent.match(OLD_IE)[0].split(\" \")[0];\r\n            info.browserVersion = agent.match(OLD_IE)[0].split(\" \")[1];\r\n            return info;\r\n        }\r\n        // Edge\r\n        if (agent.indexOf(\"edge\") > 0) {\r\n            info.browser = agent.match(REGSTR_EDGE)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_EDGE)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // firefox\r\n        if (agent.indexOf(\"firefox\") > 0) {\r\n            info.browser = agent.match(REGSTR_FF)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_FF)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // Opera\r\n        if (agent.indexOf(\"opr\") > 0) {\r\n            info.browser = agent.match(REGSTR_OPERA)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_OPERA)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // Safari\r\n        if (agent.indexOf(\"safari\") > 0 && agent.indexOf(\"chrome\") < 0) {\r\n            info.browser = agent.match(REGSTR_SAF)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_SAF)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        // Chrome\r\n        if (agent.indexOf(\"chrome\") > 0) {\r\n            info.browser = agent.match(REGSTR_CHROME)[0].split(\"/\")[0];\r\n            info.browserVersion = agent.match(REGSTR_CHROME)[0].split(\"/\")[1];\r\n            return info;\r\n        }\r\n        else {\r\n            info.code = -1;\r\n            return info;\r\n        }\r\n    };\r\n    // TODO: 获取小程序设备信息\r\n    WebToolkit.getWxappInfo = function () {\r\n        return {\r\n            system: 'WXAPP',\r\n            browser: 'WXAPP',\r\n            browserVersion: '1.0'\r\n        };\r\n    };\r\n    // TODO: 获取ReactNative设备信息\r\n    WebToolkit.getReactNativeInfo = function () {\r\n        return {\r\n            system: 'RNNative',\r\n            browser: 'RNNative',\r\n            browserVersion: '1.0'\r\n        };\r\n    };\r\n    // TODO: 获取UniApp设备信息\r\n    WebToolkit.getUniAppInfo = function () {\r\n        return {\r\n            system: 'UNIAPP',\r\n            browser: 'UNIAPP',\r\n            browserVersion: '1.0'\r\n        };\r\n    };\r\n    // 动态加入script 到head 标签处\r\n    WebToolkit.loadJS = function (url, callback) {\r\n        var script = document.createElement('script'), fn = callback || function () { };\r\n        script.type = 'text/javascript';\r\n        // document.getElementsByTagName('head')[0].children[16].outerHTML.indexOf('http://pv.sohu.com/cityjson?ie=utf-8')\r\n        var exist = false;\r\n        for (var v in document.getElementsByTagName('head')[0].children) {\r\n            var dom = document.getElementsByTagName('head')[0].children[v];\r\n            if (dom.outerHTML !== undefined && dom.outerHTML.indexOf(url) >= 0) {\r\n                exist = true;\r\n            }\r\n        }\r\n        if (exist) {\r\n            fn();\r\n            return;\r\n        }\r\n        //IE\r\n        if (script.readyState) {\r\n            script.onreadystatechange = function () {\r\n                if (script.readyState == 'loaded' || script.readyState == 'complete') {\r\n                    script.onreadystatechange = null;\r\n                    fn();\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            //其他浏览器\r\n            script.onload = function () {\r\n                fn();\r\n            };\r\n        }\r\n        script.src = url;\r\n        document.getElementsByTagName('head')[0].appendChild(script);\r\n    };\r\n    // 获取当前ip信息(fetch方式)\r\n    WebToolkit.getIpInfoByFetch = function (callback) {\r\n        var url = 'http://pv.sohu.com/cityjson?ie=utf-8';\r\n        var fetch = Fetch_1[\"default\"].getFetchToolkit();\r\n        var request = { method: \"GET\", mode: \"cors\", headers: { \"Content-Type\": \"application/json\" } };\r\n        return fetch(url, request).then(function (response) {\r\n            return response.text();\r\n        }).then(function (res) {\r\n            if (typeof callback === 'function') {\r\n                var currentCity = eval('_current_city=' + res.replace('var returnCitySN = ', ''));\r\n                callback(currentCity);\r\n            }\r\n        })[\"catch\"](function (e) {\r\n            Logger_1[\"default\"].trace(e);\r\n        });\r\n    };\r\n    // 获取当前ip信息(动态插入script脚本方式)\r\n    WebToolkit.getIpInfoByInsertScript = function (callback) {\r\n        var url = 'http://pv.sohu.com/cityjson?ie=utf-8';\r\n        WebToolkit.loadJS(url, function () {\r\n            callback(window['returnCitySN']);\r\n        });\r\n    };\r\n    WebToolkit.getIpInfo = function (callback) {\r\n        // 小程序的情况需要把pv.sohu.com域名加入白名单中\r\n        WebToolkit.getIpInfoByFetch(callback);\r\n    };\r\n    // 获取客户端设备信息\r\n    WebToolkit.getDeviceInfo = function () {\r\n        var deviceInfo = WebToolkit.getUniAppInfo();\r\n        return deviceInfo;\r\n    };\r\n    WebToolkit.base64Encode = function (str) {\r\n        return Base64.encode(str);\r\n    };\r\n    WebToolkit.base64Decode = function (str) {\r\n        return Base64.decode(str);\r\n    };\r\n    return WebToolkit;\r\n}());\r\nexports[\"default\"] = WebToolkit;\r\n","var global =\r\n  (typeof globalThis !== 'undefined' && globalThis) ||\r\n  (typeof self !== 'undefined' && self) ||\r\n  (typeof global !== 'undefined' && global)\r\n\r\nvar support = {\r\n  searchParams: 'URLSearchParams' in global,\r\n  iterable: 'Symbol' in global && 'iterator' in Symbol,\r\n  blob:\r\n    'FileReader' in global &&\r\n    'Blob' in global &&\r\n    (function() {\r\n      try {\r\n        new Blob()\r\n        return true\r\n      } catch (e) {\r\n        return false\r\n      }\r\n    })(),\r\n  formData: 'FormData' in global,\r\n  arrayBuffer: 'ArrayBuffer' in global\r\n}\r\n\r\nfunction isDataView(obj) {\r\n  return obj && DataView.prototype.isPrototypeOf(obj)\r\n}\r\n\r\nif (support.arrayBuffer) {\r\n  var viewClasses = [\r\n    '[object Int8Array]',\r\n    '[object Uint8Array]',\r\n    '[object Uint8ClampedArray]',\r\n    '[object Int16Array]',\r\n    '[object Uint16Array]',\r\n    '[object Int32Array]',\r\n    '[object Uint32Array]',\r\n    '[object Float32Array]',\r\n    '[object Float64Array]'\r\n  ]\r\n\r\n  var isArrayBufferView =\r\n    ArrayBuffer.isView ||\r\n    function(obj) {\r\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\r\n    }\r\n}\r\n\r\nfunction normalizeName(name) {\r\n  if (typeof name !== 'string') {\r\n    name = String(name)\r\n  }\r\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~!]/i.test(name) || name === '') {\r\n    throw new TypeError('Invalid character in header field name: \"' + name + '\"')\r\n  }\r\n  // return name.toLowerCase()\r\n  return name;\r\n}\r\n\r\nfunction normalizeValue(value) {\r\n  if (typeof value !== 'string') {\r\n    value = String(value)\r\n  }\r\n  return value\r\n}\r\n\r\n// Build a destructive iterator for the value list\r\nfunction iteratorFor(items) {\r\n  var iterator = {\r\n    next: function() {\r\n      var value = items.shift()\r\n      return {done: value === undefined, value: value}\r\n    }\r\n  }\r\n\r\n  if (support.iterable) {\r\n    iterator[Symbol.iterator] = function() {\r\n      return iterator\r\n    }\r\n  }\r\n\r\n  return iterator\r\n}\r\n\r\nexport function Headers(headers) {\r\n  this.map = {}\r\n\r\n  if (headers instanceof Headers) {\r\n    headers.forEach(function(value, name) {\r\n      this.append(name, value)\r\n    }, this)\r\n  } else if (Array.isArray(headers)) {\r\n    headers.forEach(function(header) {\r\n      this.append(header[0], header[1])\r\n    }, this)\r\n  } else if (headers) {\r\n    Object.getOwnPropertyNames(headers).forEach(function(name) {\r\n      this.append(name, headers[name])\r\n    }, this)\r\n  }\r\n}\r\n\r\nHeaders.prototype.append = function(name, value) {\r\n  name = normalizeName(name)\r\n  value = normalizeValue(value)\r\n  var oldValue = this.map[name]\r\n  this.map[name] = oldValue ? oldValue + ', ' + value : value\r\n}\r\n\r\nHeaders.prototype['delete'] = function(name) {\r\n  delete this.map[normalizeName(name)]\r\n}\r\n\r\nHeaders.prototype.get = function(name) {\r\n  name = normalizeName(name)\r\n  return this.has(name) ? this.map[name] : null\r\n}\r\n\r\nHeaders.prototype.has = function(name) {\r\n  return this.map.hasOwnProperty(normalizeName(name))\r\n}\r\n\r\nHeaders.prototype.set = function(name, value) {\r\n  this.map[normalizeName(name)] = normalizeValue(value)\r\n}\r\n\r\nHeaders.prototype.forEach = function(callback, thisArg) {\r\n  for (var name in this.map) {\r\n    if (this.map.hasOwnProperty(name)) {\r\n      callback.call(thisArg, this.map[name], name, this)\r\n    }\r\n  }\r\n}\r\n\r\nHeaders.prototype.keys = function() {\r\n  var items = []\r\n  this.forEach(function(value, name) {\r\n    items.push(name)\r\n  })\r\n  return iteratorFor(items)\r\n}\r\n\r\nHeaders.prototype.values = function() {\r\n  var items = []\r\n  this.forEach(function(value) {\r\n    items.push(value)\r\n  })\r\n  return iteratorFor(items)\r\n}\r\n\r\nHeaders.prototype.entries = function() {\r\n  var items = []\r\n  this.forEach(function(value, name) {\r\n    items.push([name, value])\r\n  })\r\n  return iteratorFor(items)\r\n}\r\n\r\nif (support.iterable) {\r\n  Headers.prototype[Symbol.iterator] = Headers.prototype.entries\r\n}\r\n\r\nfunction consumed(body) {\r\n  if (body.bodyUsed) {\r\n    return Promise.reject(new TypeError('Already read'))\r\n  }\r\n  body.bodyUsed = true\r\n}\r\n\r\nfunction fileReaderReady(reader) {\r\n  return new Promise(function(resolve, reject) {\r\n    reader.onload = function() {\r\n      resolve(reader.result)\r\n    }\r\n    reader.onerror = function() {\r\n      reject(reader.error)\r\n    }\r\n  })\r\n}\r\n\r\nfunction readBlobAsArrayBuffer(blob) {\r\n  var reader = new FileReader()\r\n  var promise = fileReaderReady(reader)\r\n  reader.readAsArrayBuffer(blob)\r\n  return promise\r\n}\r\n\r\nfunction readBlobAsText(blob) {\r\n  var reader = new FileReader()\r\n  var promise = fileReaderReady(reader)\r\n  reader.readAsText(blob)\r\n  return promise\r\n}\r\n\r\nfunction readArrayBufferAsText(buf) {\r\n  var view = new Uint8Array(buf)\r\n  var chars = new Array(view.length)\r\n\r\n  for (var i = 0; i < view.length; i++) {\r\n    chars[i] = String.fromCharCode(view[i])\r\n  }\r\n  return chars.join('')\r\n}\r\n\r\nfunction bufferClone(buf) {\r\n  if (buf.slice) {\r\n    return buf.slice(0)\r\n  } else {\r\n    var view = new Uint8Array(buf.byteLength)\r\n    view.set(new Uint8Array(buf))\r\n    return view.buffer\r\n  }\r\n}\r\n\r\nfunction Body() {\r\n  this.bodyUsed = false\r\n\r\n  this._initBody = function(body) {\r\n    /*\r\n      fetch-mock wraps the Response object in an ES6 Proxy to\r\n      provide useful test harness features such as flush. However, on\r\n      ES5 browsers without fetch or Proxy support pollyfills must be used;\r\n      the proxy-pollyfill is unable to proxy an attribute unless it exists\r\n      on the object before the Proxy is created. This change ensures\r\n      Response.bodyUsed exists on the instance, while maintaining the\r\n      semantic of setting Request.bodyUsed in the constructor before\r\n      _initBody is called.\r\n    */\r\n    this.bodyUsed = this.bodyUsed\r\n    this._bodyInit = body\r\n    if (!body) {\r\n      this._bodyText = ''\r\n    } else if (typeof body === 'string') {\r\n      this._bodyText = body\r\n    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\r\n      this._bodyBlob = body\r\n    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\r\n      this._bodyFormData = body\r\n    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\r\n      this._bodyText = body.toString()\r\n    } else if (support.arrayBuffer && support.blob && isDataView(body)) {\r\n      this._bodyArrayBuffer = bufferClone(body.buffer)\r\n      // IE 10-11 can't handle a DataView body.\r\n      this._bodyInit = new Blob([this._bodyArrayBuffer])\r\n    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\r\n      this._bodyArrayBuffer = bufferClone(body)\r\n    } else {\r\n      this._bodyText = body = Object.prototype.toString.call(body)\r\n    }\r\n\r\n    if (!this.headers.get('Content-Type')) {\r\n      if (typeof body === 'string') {\r\n        this.headers.set('Content-Type', 'text/plain;charset=UTF-8')\r\n      } else if (this._bodyBlob && this._bodyBlob.type) {\r\n        this.headers.set('Content-Type', this._bodyBlob.type)\r\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\r\n        this.headers.set('Content-Type', 'application/x-www-form-urlencoded;charset=UTF-8')\r\n      }\r\n    }\r\n  }\r\n\r\n  if (support.blob) {\r\n    this.blob = function() {\r\n      var rejected = consumed(this)\r\n      if (rejected) {\r\n        return rejected\r\n      }\r\n\r\n      if (this._bodyBlob) {\r\n        return Promise.resolve(this._bodyBlob)\r\n      } else if (this._bodyArrayBuffer) {\r\n        return Promise.resolve(new Blob([this._bodyArrayBuffer]))\r\n      } else if (this._bodyFormData) {\r\n        throw new Error('could not read FormData body as blob')\r\n      } else {\r\n        return Promise.resolve(new Blob([this._bodyText]))\r\n      }\r\n    }\r\n\r\n    this.arrayBuffer = function() {\r\n      if (this._bodyArrayBuffer) {\r\n        var isConsumed = consumed(this)\r\n        if (isConsumed) {\r\n          return isConsumed\r\n        }\r\n        if (ArrayBuffer.isView(this._bodyArrayBuffer)) {\r\n          return Promise.resolve(\r\n            this._bodyArrayBuffer.buffer.slice(\r\n              this._bodyArrayBuffer.byteOffset,\r\n              this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength\r\n            )\r\n          )\r\n        } else {\r\n          return Promise.resolve(this._bodyArrayBuffer)\r\n        }\r\n      } else {\r\n        return this.blob().then(readBlobAsArrayBuffer)\r\n      }\r\n    }\r\n  }\r\n\r\n  this.text = function() {\r\n    var rejected = consumed(this)\r\n    if (rejected) {\r\n      return rejected\r\n    }\r\n\r\n    if (this._bodyBlob) {\r\n      return readBlobAsText(this._bodyBlob)\r\n    } else if (this._bodyArrayBuffer) {\r\n      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\r\n    } else if (this._bodyFormData) {\r\n      throw new Error('could not read FormData body as text')\r\n    } else {\r\n      return Promise.resolve(this._bodyText)\r\n    }\r\n  }\r\n\r\n  if (support.formData) {\r\n    this.formData = function() {\r\n      return this.text().then(decode)\r\n    }\r\n  }\r\n\r\n  this.json = function() {\r\n    return this.text().then(JSON.parse)\r\n  }\r\n\r\n  return this\r\n}\r\n\r\n// HTTP methods whose capitalization should be normalized\r\nvar methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\r\n\r\nfunction normalizeMethod(method) {\r\n  var upcased = method.toUpperCase()\r\n  return methods.indexOf(upcased) > -1 ? upcased : method\r\n}\r\n\r\nexport function Request(input, options) {\r\n  if (!(this instanceof Request)) {\r\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\r\n  }\r\n\r\n  options = options || {}\r\n  var body = options.body\r\n\r\n  if (input instanceof Request) {\r\n    if (input.bodyUsed) {\r\n      throw new TypeError('Already read')\r\n    }\r\n    this.url = input.url\r\n    this.credentials = input.credentials\r\n    if (!options.headers) {\r\n      this.headers = new Headers(input.headers)\r\n    }\r\n    this.method = input.method\r\n    this.mode = input.mode\r\n    this.signal = input.signal\r\n    if (!body && input._bodyInit != null) {\r\n      body = input._bodyInit\r\n      input.bodyUsed = true\r\n    }\r\n  } else {\r\n    this.url = String(input)\r\n  }\r\n\r\n  this.credentials = options.credentials || this.credentials || 'same-origin'\r\n  if (options.headers || !this.headers) {\r\n    this.headers = new Headers(options.headers)\r\n  }\r\n  this.method = normalizeMethod(options.method || this.method || 'GET')\r\n  this.mode = options.mode || this.mode || null\r\n  this.signal = options.signal || this.signal\r\n  this.referrer = null\r\n\r\n  if ((this.method === 'GET' || this.method === 'HEAD') && body) {\r\n    throw new TypeError('Body not allowed for GET or HEAD requests')\r\n  }\r\n  this._initBody(body)\r\n\r\n  if (this.method === 'GET' || this.method === 'HEAD') {\r\n    if (options.cache === 'no-store' || options.cache === 'no-cache') {\r\n      // Search for a '_' parameter in the query string\r\n      var reParamSearch = /([?&])_=[^&]*/\r\n      if (reParamSearch.test(this.url)) {\r\n        // If it already exists then set the value with the current time\r\n        this.url = this.url.replace(reParamSearch, '$1_=' + new Date().getTime())\r\n      } else {\r\n        // Otherwise add a new '_' parameter to the end with the current time\r\n        var reQueryString = /\\?/\r\n        this.url += (reQueryString.test(this.url) ? '&' : '?') + '_=' + new Date().getTime()\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nRequest.prototype.clone = function() {\r\n  return new Request(this, {body: this._bodyInit})\r\n}\r\n\r\nfunction decode(body) {\r\n  var form = new FormData()\r\n  body\r\n    .trim()\r\n    .split('&')\r\n    .forEach(function(bytes) {\r\n      if (bytes) {\r\n        var split = bytes.split('=')\r\n        var name = split.shift().replace(/\\+/g, ' ')\r\n        var value = split.join('=').replace(/\\+/g, ' ')\r\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\r\n      }\r\n    })\r\n  return form\r\n}\r\n\r\nfunction parseHeaders(rawHeaders) {\r\n  var headers = new Headers()\r\n  // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\r\n  // https://tools.ietf.org/html/rfc7230#section-3.2\r\n  var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\r\n  // Avoiding split via regex to work around a common IE11 bug with the core-js 3.6.0 regex polyfill\r\n  // https://github.com/github/fetch/issues/748\r\n  // https://github.com/zloirock/core-js/issues/751\r\n  preProcessedHeaders\r\n    .split('\\r')\r\n    .map(function(header) {\r\n      return header.indexOf('\\n') === 0 ? header.substr(1, header.length) : header\r\n    })\r\n    .forEach(function(line) {\r\n      var parts = line.split(':')\r\n      var key = parts.shift().trim()\r\n      if (key) {\r\n        var value = parts.join(':').trim()\r\n        headers.append(key, value)\r\n      }\r\n    })\r\n  return headers\r\n}\r\n\r\nfunction parseUniappHeaders(rawHeaders) {\r\n  var headers = new Headers()\r\n  for(var key in rawHeaders){\r\n    headers.append(key, rawHeaders[key])\r\n  }\r\n  return headers\r\n}\r\n\r\n\r\nBody.call(Request.prototype)\r\n\r\nexport function Response(bodyInit, options) {\r\n  if (!(this instanceof Response)) {\r\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\r\n  }\r\n  if (!options) {\r\n    options = {}\r\n  }\r\n\r\n  this.type = 'default'\r\n  this.status = options.status === undefined ? 200 : options.status\r\n  this.ok = this.status >= 200 && this.status < 300\r\n  this.statusText = options.statusText === undefined ? '' : '' + options.statusText\r\n  this.headers = new Headers(options.headers)\r\n  this.url = options.url || ''\r\n  this._initBody(bodyInit)\r\n}\r\n\r\nBody.call(Response.prototype)\r\n\r\nResponse.prototype.clone = function() {\r\n  return new Response(this._bodyInit, {\r\n    status: this.status,\r\n    statusText: this.statusText,\r\n    headers: new Headers(this.headers),\r\n    url: this.url\r\n  })\r\n}\r\n\r\nResponse.error = function() {\r\n  var response = new Response(null, {status: 0, statusText: ''})\r\n  response.type = 'error'\r\n  return response\r\n}\r\n\r\nvar redirectStatuses = [301, 302, 303, 307, 308]\r\n\r\nResponse.redirect = function(url, status) {\r\n  if (redirectStatuses.indexOf(status) === -1) {\r\n    throw new RangeError('Invalid status code')\r\n  }\r\n\r\n  return new Response(null, {status: status, headers: {location: url}})\r\n}\r\n\r\nexport var DOMException = global.DOMException\r\ntry {\r\n  new DOMException()\r\n} catch (err) {\r\n  DOMException = function(message, name) {\r\n    this.message = message\r\n    this.name = name\r\n    var error = Error(message)\r\n    this.stack = error.stack\r\n  }\r\n  DOMException.prototype = Object.create(Error.prototype)\r\n  DOMException.prototype.constructor = DOMException\r\n}\r\n\r\n// 从 whatwg-fetch 项目改写\r\nexport function fetch(input, init) {\r\n  return new Promise(function(resolve, reject) {\r\n    var request = new Request(input, init)\r\n\r\n    if (request.signal && request.signal.aborted) {\r\n      return reject(new DOMException('Aborted', 'AbortError'))\r\n    }\r\n\r\n    function fixUrl(url) {\r\n      try {\r\n        return url === '' && global.location.href ? global.location.href : url\r\n      } catch (e) {\r\n        return url\r\n      }\r\n    }\r\n    function isJson(json) {\r\n      try {\r\n        if (typeof json == \"object\") {\r\n          return true;\r\n        }\r\n        if (typeof json == \"string\") {\r\n          if (typeof JSON.parse(str) == \"object\") {\r\n            return true;\r\n          }\r\n        }\r\n      } catch(e) {\r\n      }\r\n      return false;\r\n    }\r\n    function toStr(json) {\r\n      try {\r\n        if (typeof json == \"object\") {\r\n          return JSON.stringify(json);\r\n        }\r\n        if (typeof json == \"string\") {\r\n           return json;\r\n        }\r\n      } catch(e) {\r\n      }\r\n      return json.toString();\r\n    }\r\n\r\n\r\n    let rawBody = typeof request._bodyInit === 'undefined' ? null : request._bodyInit;\r\n    if(request.headers.hasOwnProperty('Content-Type') && request.headers['Content-Type'].indexOf('application/json') >= 0){\r\n       if(request.method.toUpperCase() === 'POST'){\r\n         rawBody = JSON.parse(rawBody); // uniapp框架遇到 method = 'POST' 且 Content-Type = 'application/json' 会自动序列化\r\n       }\r\n    }\r\n    const requestTask = uni.request({\r\n      url: fixUrl(request.url),\r\n      method: request.method,\r\n      data: rawBody,\r\n      header: request.headers.map,\r\n      complete: (resp)=> {\r\n        // Logger.info(resp);\r\n        if (request.signal) {\r\n          request.signal.removeEventListener('abort', abortXhr);\r\n        }\r\n        if(resp.errMsg.indexOf('fail') >= 0){\r\n          setTimeout(function() {\r\n            reject(new TypeError('Network request failed'))\r\n          }, 0);\r\n          return;\r\n        }\r\n        // if(resp.statusCode !== 200){\r\n        //   setTimeout(function() {\r\n        //     reject(new TypeError('Network request failed, statusCode:' + resp.statusCode + \"  full text:\" + JSON.stringify(resp.data)))\r\n        //   }, 0)\r\n        //   return;\r\n        // }\r\n        var options = {\r\n          status: resp.statusCode,\r\n          statusText: resp.data ? toStr(resp.data) : '',\r\n          headers: parseUniappHeaders(resp.header || {})\r\n        };\r\n        options.url = options.headers.get('X-Request-URL')\r\n        var body = options.statusText;\r\n        setTimeout(function() {\r\n          resolve(new Response(body, options))\r\n        }, 0)\r\n\r\n      }\r\n    });\r\n    function abortXhr() {\r\n      requestTask.abort()\r\n    }\r\n    if (request.signal) {\r\n      request.signal.addEventListener('abort', abortXhr)\r\n    }\r\n\r\n  })\r\n}\r\n\r\nfetch.polyfill = true\r\n\r\nif (!global.fetch) {\r\n  global.fetch = fetch\r\n  global.Headers = Headers\r\n  global.Request = Request\r\n  global.Response = Response\r\n}\r\n","var _globalThis;\nif (typeof globalThis === 'object') {\n\t_globalThis = globalThis;\n} else {\n\ttry {\n\t\t_globalThis = require('es5-ext/global');\n\t} catch (error) {\n\t} finally {\n\t\tif (!_globalThis && typeof window !== 'undefined') { _globalThis = window; }\n\t\tif (!_globalThis) { throw new Error('Could not determine global this'); }\n\t}\n}\n\nvar NativeWebSocket = _globalThis.WebSocket || _globalThis.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new NativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new NativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\nif (NativeWebSocket) {\n\t['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'].forEach(function(prop) {\n\t\tObject.defineProperty(W3CWebSocket, prop, {\n\t\t\tget: function() { return NativeWebSocket[prop]; }\n\t\t});\n\t});\n}\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : NativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n","var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Fallback to standard globalThis if available\n\tif (typeof globalThis === \"object\" && globalThis) return globalThis;\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of updates to Object.prototype being restricted\n\t\t// via preventExtensions, seal or freeze\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ works, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n","module.exports = require('../package.json').version;\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.RequestBase = void 0;\r\nvar RequestBase = /** @class */ (function () {\r\n    function RequestBase(appId, clientType, imei) {\r\n        this.appId = appId;\r\n        this.clientType = clientType;\r\n        this.imei = imei;\r\n    }\r\n    return RequestBase;\r\n}());\r\nexports.RequestBase = RequestBase;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.RequestParams = void 0;\r\nvar RequestParams = /** @class */ (function () {\r\n    function RequestParams(appId, identifier, userSign) {\r\n        this.appId = appId;\r\n        this.identifier = identifier;\r\n        this.userSign = userSign;\r\n    }\r\n    return RequestParams;\r\n}());\r\nexports.RequestParams = RequestParams;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar Logger_1 = require(\"../log/Logger\");\r\nvar ImClient_1 = require(\"./ImClient\");\r\nvar ApiResponse_1 = require(\"../model/ApiResponse\");\r\nvar utils_1 = require(\"../common/utils\");\r\nvar Fetch_1 = require(\"../common/Fetch\");\r\nvar HttpApi = /** @class */ (function () {\r\n    function HttpApi(url) {\r\n        this.url = \"\"; //http://127.0.0.1:8000/v1\r\n        this.url = url;\r\n    }\r\n    HttpApi.prototype.call = function (url, params, body) {\r\n        var userId = ImClient_1.imClient.userId;\r\n        Logger_1[\"default\"].info(userId);\r\n        var reqUrl = this.url + url;\r\n        if (params != null) {\r\n            var paramStr = this.setQueryConfig(params);\r\n            console.log(paramStr);\r\n            reqUrl += paramStr;\r\n        }\r\n        var requestMethod = \"POST\";\r\n        var headers = {\r\n            'Content-Type': 'application/json',\r\n        };\r\n        var request = { method: requestMethod, headers: headers, mode: 'cors', body: utils_1[\"default\"].json(body) };\r\n        return this.httpFetch(reqUrl, request);\r\n    };\r\n    HttpApi.prototype.setQueryConfig = function (params) {\r\n        var _str = \"?\";\r\n        for (var o in params) {\r\n            _str += o + \"=\" + params[o] + \"&\";\r\n        }\r\n        var _str = _str.substring(0, _str.length - 1); //末尾是&\r\n        return _str;\r\n    };\r\n    HttpApi.prototype.httpFetch = function (url, request) {\r\n        var _this = this;\r\n        console.log(\"httpFetch\");\r\n        var rnfetch1 = Fetch_1[\"default\"].getFetchToolkit();\r\n        return rnfetch1(url, request).then(function (response) {\r\n            console.log(response);\r\n            return response.json();\r\n        }).then(function (res) {\r\n            Logger_1[\"default\"].info(\"==> [\" + request.method + \"] \" + url + \" back:\" + utils_1[\"default\"].json(res));\r\n            var resp = _this.response2ApiResponse(res);\r\n            if (resp.isFailed()) {\r\n                return Promise.reject(resp);\r\n            }\r\n            // return Promise.resolve(this.response2ApiResponse(res));\r\n            return Promise.resolve(resp);\r\n        });\r\n    };\r\n    HttpApi.prototype.response2ApiResponse = function (response) {\r\n        var apiResponse = new ApiResponse_1[\"default\"](true);\r\n        apiResponse.data = response.data;\r\n        apiResponse.msg = response.msg;\r\n        apiResponse.code = response.code;\r\n        return apiResponse;\r\n    };\r\n    return HttpApi;\r\n}());\r\nexports[\"default\"] = HttpApi;\r\n// export const httpApi = new HttpApi();\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nvar ApiResponse = /** @class */ (function () {\r\n    function ApiResponse(succeed) {\r\n        if (succeed === void 0) { succeed = false; }\r\n        this.msg = '';\r\n        this.data = null;\r\n        if (succeed) {\r\n            this.code = 200;\r\n        }\r\n    }\r\n    ApiResponse.prototype.isSucceed = function () {\r\n        return this.code === 200;\r\n    };\r\n    ApiResponse.prototype.isFailed = function () {\r\n        return !this.isSucceed();\r\n    };\r\n    return ApiResponse;\r\n}());\r\nexports[\"default\"] = ApiResponse;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.ConversationEventCommand = exports.UserEventCommand = exports.SystemCommand = exports.GroupCommand = exports.FriendShipCommand = exports.MessageCommand = void 0;\r\nvar MessageCommand;\r\n(function (MessageCommand) {\r\n    MessageCommand[MessageCommand[\"MSG_P2P\"] = 1103] = \"MSG_P2P\";\r\n    MessageCommand[MessageCommand[\"MSG_P2P_SYNC\"] = 1108] = \"MSG_P2P_SYNC\";\r\n    //发送消息已读   1106\r\n    MessageCommand[MessageCommand[\"MSG_READED\"] = 1106] = \"MSG_READED\";\r\n    //消息接收ack\r\n    MessageCommand[MessageCommand[\"MSG_RECIVE_ACK\"] = 1107] = \"MSG_RECIVE_ACK\";\r\n    //单聊消息ACK 1046\r\n    MessageCommand[MessageCommand[\"MSG_ACK\"] = 1046] = \"MSG_ACK\";\r\n    // 消息撤回 1050\r\n    MessageCommand[MessageCommand[\"MSG_RECALL\"] = 1050] = \"MSG_RECALL\";\r\n    // //消息撤回通知 1052\r\n    MessageCommand[MessageCommand[\"MSG_RECALL_NOTIFY\"] = 1052] = \"MSG_RECALL_NOTIFY\";\r\n    // 消息撤回回包 1051\r\n    MessageCommand[MessageCommand[\"MSG_RECALL_ACK\"] = 1051] = \"MSG_RECALL_ACK\";\r\n    // //消息已读通知 1053\r\n    MessageCommand[MessageCommand[\"MSG_READED_NOTIFY\"] = 1053] = \"MSG_READED_NOTIFY\";\r\n})(MessageCommand || (MessageCommand = {}));\r\nexports.MessageCommand = MessageCommand;\r\nvar FriendShipCommand;\r\n(function (FriendShipCommand) {\r\n    //添加好友 3000\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_ADD\"] = 3000] = \"FRIEND_ADD\";\r\n    //更新好友 3001\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_UPDATE\"] = 3001] = \"FRIEND_UPDATE\";\r\n    //删除好友 3002\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_DELETE\"] = 3002] = \"FRIEND_DELETE\";\r\n    //好友申请 3003\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_REQUEST\"] = 3003] = \"FRIEND_REQUEST\";\r\n    //好友申请已读 3004\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_REQUEST_READ\"] = 3004] = \"FRIEND_REQUEST_READ\";\r\n    //好友申请审批 3005\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_REQUEST_APPROVER\"] = 3005] = \"FRIEND_REQUEST_APPROVER\";\r\n    //添加黑名单 3010\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_BLACK_ADD\"] = 3010] = \"FRIEND_BLACK_ADD\";\r\n    //移除黑名单 3011\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_BLACK_DELETE\"] = 3011] = \"FRIEND_BLACK_DELETE\";\r\n    //新建好友分组 3012\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_ADD\"] = 3012] = \"FRIEND_GROUP_ADD\";\r\n    //删除好友分组 3013\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_DELETE\"] = 3013] = \"FRIEND_GROUP_DELETE\";\r\n    //好友分组添加成员 3014\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_MEMBER_ADD\"] = 3014] = \"FRIEND_GROUP_MEMBER_ADD\";\r\n    //好友分组移除成员 3015\r\n    FriendShipCommand[FriendShipCommand[\"FRIEND_GROUP_MEMBER_DELETE\"] = 3015] = \"FRIEND_GROUP_MEMBER_DELETE\";\r\n})(FriendShipCommand || (FriendShipCommand = {}));\r\nexports.FriendShipCommand = FriendShipCommand;\r\nvar GroupCommand;\r\n(function (GroupCommand) {\r\n    /**\r\n         * 推送申请入群通知 2000\r\n         */\r\n    GroupCommand[GroupCommand[\"JOIN_GROUP\"] = 2000] = \"JOIN_GROUP\";\r\n    /**\r\n     * 推送添加群成员 2001，通知给所有管理员和本人\r\n     */\r\n    GroupCommand[GroupCommand[\"ADDED_MEMBER\"] = 2001] = \"ADDED_MEMBER\";\r\n    /**\r\n     * 推送创建群组通知 2002，通知给所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"CREATED_GROUP\"] = 2002] = \"CREATED_GROUP\";\r\n    /**\r\n     * 推送更新群组通知 2003，通知给所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"UPDATED_GROUP\"] = 2003] = \"UPDATED_GROUP\";\r\n    /**\r\n     * 推送退出群组通知 2004，通知给管理员和操作人\r\n     */\r\n    GroupCommand[GroupCommand[\"EXIT_GROUP\"] = 2004] = \"EXIT_GROUP\";\r\n    /**\r\n     * 推送修改群成员通知 2005，通知给管理员和被操作人\r\n     */\r\n    GroupCommand[GroupCommand[\"UPDATED_MEMBER\"] = 2005] = \"UPDATED_MEMBER\";\r\n    /**\r\n     * 推送删除群成员通知 2006，通知给所有群成员和被踢人\r\n     */\r\n    GroupCommand[GroupCommand[\"DELETED_MEMBER\"] = 2006] = \"DELETED_MEMBER\";\r\n    /**\r\n     * 推送解散群通知 2007，通知所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"DESTROY_GROUP\"] = 2007] = \"DESTROY_GROUP\";\r\n    /**\r\n     * 推送转让群主 2008，通知所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"TRANSFER_GROUP\"] = 2008] = \"TRANSFER_GROUP\";\r\n    /**\r\n     * 禁言群 2009，通知所有人\r\n     */\r\n    GroupCommand[GroupCommand[\"MUTE_GROUP\"] = 2009] = \"MUTE_GROUP\";\r\n    /**\r\n     * 禁言/解禁 群成员 2010，通知管理员和被操作人\r\n     */\r\n    GroupCommand[GroupCommand[\"SPEAK_GOUP_MEMBER\"] = 2010] = \"SPEAK_GOUP_MEMBER\";\r\n    //群聊消息收发   2104\r\n    GroupCommand[GroupCommand[\"MSG_GROUP\"] = 2104] = \"MSG_GROUP\";\r\n    //群聊消息收发同步消息   2105\r\n    GroupCommand[GroupCommand[\"MSG_GROUP_SYNC\"] = 2105] = \"MSG_GROUP_SYNC\";\r\n    //群聊消息ACK 2047\r\n    GroupCommand[GroupCommand[\"GROUP_MSG_ACK\"] = 2047] = \"GROUP_MSG_ACK\";\r\n})(GroupCommand || (GroupCommand = {}));\r\nexports.GroupCommand = GroupCommand;\r\nvar SystemCommand;\r\n(function (SystemCommand) {\r\n    //心跳 9999\r\n    SystemCommand[SystemCommand[\"PING\"] = 9999] = \"PING\";\r\n    //登陸  9000\r\n    SystemCommand[SystemCommand[\"LOGIN\"] = 9000] = \"LOGIN\";\r\n    //登录ack  9001\r\n    SystemCommand[SystemCommand[\"LOGINACK\"] = 9001] = \"LOGINACK\";\r\n    //下线通知 用于多端互斥  9002\r\n    SystemCommand[SystemCommand[\"MUTUALLOGIN\"] = 9002] = \"MUTUALLOGIN\";\r\n    //登出  9003\r\n    SystemCommand[SystemCommand[\"LOGOUT\"] = 9003] = \"LOGOUT\";\r\n})(SystemCommand || (SystemCommand = {}));\r\nexports.SystemCommand = SystemCommand;\r\nvar UserEventCommand;\r\n(function (UserEventCommand) {\r\n    //4000\r\n    UserEventCommand[UserEventCommand[\"USER_MODIFY\"] = 4000] = \"USER_MODIFY\";\r\n    //4001\r\n    UserEventCommand[UserEventCommand[\"USER_ONLINE_STATUS_CHANGE\"] = 4001] = \"USER_ONLINE_STATUS_CHANGE\";\r\n    //4002 在线状态订阅\r\n    UserEventCommand[UserEventCommand[\"USER_ONLINE_STATUS_SUBSCRIBE\"] = 4002] = \"USER_ONLINE_STATUS_SUBSCRIBE\";\r\n    //4003 拉取订阅的在线状态好友,只发送给请求端\r\n    UserEventCommand[UserEventCommand[\"PULL_USER_ONLINE_STATUS\"] = 4003] = \"PULL_USER_ONLINE_STATUS\";\r\n    //4004 用户在线状态通知报文\r\n    UserEventCommand[UserEventCommand[\"USER_ONLINE_STATUS_CHANGE_NOTIFY\"] = 4004] = \"USER_ONLINE_STATUS_CHANGE_NOTIFY\";\r\n})(UserEventCommand || (UserEventCommand = {}));\r\nexports.UserEventCommand = UserEventCommand;\r\nvar ConversationEventCommand;\r\n(function (ConversationEventCommand) {\r\n    //5000 会话删除\r\n    ConversationEventCommand[ConversationEventCommand[\"CONVERSATION_DELETE\"] = 5000] = \"CONVERSATION_DELETE\";\r\n    //5001 会话修改\r\n    ConversationEventCommand[ConversationEventCommand[\"CONVERSATION_UPDATE\"] = 5001] = \"CONVERSATION_UPDATE\";\r\n})(ConversationEventCommand || (ConversationEventCommand = {}));\r\nexports.ConversationEventCommand = ConversationEventCommand;\r\n","\"use strict\";\r\nexports.__esModule = true;\r\nexports.MessagePack = void 0;\r\nvar utils_1 = require(\"../common/utils\");\r\nvar MessagePack = /** @class */ (function () {\r\n    function MessagePack(appId) {\r\n        this.messageId = utils_1[\"default\"].uuid();\r\n        this.appId = appId;\r\n        this.messageRandom = this.RangeInteger(0, 10000);\r\n        this.messageTime = Date.parse(new Date().toString());\r\n    }\r\n    MessagePack.prototype.RangeInteger = function (min, max) {\r\n        var range = max - min;\r\n        var value = Math.floor(Math.random() * range) + min;\r\n        return value;\r\n    };\r\n    MessagePack.prototype.buildTxtMessagePack = function (fromId, toId, text) {\r\n        this.fromId = fromId;\r\n        this.toId = toId;\r\n        var body = { type: 1, content: text };\r\n        this.messageBody = utils_1[\"default\"].json(body);\r\n    };\r\n    return MessagePack;\r\n}());\r\nexports.MessagePack = MessagePack;\r\n"],"sourceRoot":""}